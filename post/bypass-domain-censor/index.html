<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 2.29.1"/><title data-react-helmet="true">Onichandame&#x27;s Home-Bypass Domain Censorship | Onichandame&#x27;s Home</title><meta data-react-helmet="true" name="description" content=""/><meta data-react-helmet="true" property="og:title" content="Bypass Domain Censorship"/><meta data-react-helmet="true" property="og:description" content=""/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Xiao Zhang"/><meta data-react-helmet="true" name="twitter:title" content="Bypass Domain Censorship"/><meta data-react-helmet="true" name="twitter:description" content=""/><link rel="icon" href="/favicon-32x32.png?v=4a9773549091c227cd2eb82ccd9c5e3a" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link as="script" rel="preload" href="/webpack-runtime-d10adb79bdd5453eb719.js"/><link as="script" rel="preload" href="/framework-beda7bde9d7dca0755ce.js"/><link as="script" rel="preload" href="/4bdf9057-0bb9c0f56db98bc1f503.js"/><link as="script" rel="preload" href="/fb7d5399-58798ebfc9c8cc593565.js"/><link as="script" rel="preload" href="/d5b08420-07f367315fbba8850a0e.js"/><link as="script" rel="preload" href="/app-a22ec1c5bb75fda00d04.js"/><link as="script" rel="preload" href="/c67bc222f24cf6cac9dade081f06b9686691a306-5cb5fd77d6c6846ab638.js"/><link as="script" rel="preload" href="/component---src-template-blog-tsx-dc3e87313bcd461c5423.js"/><link as="fetch" rel="preload" href="/page-data/post/bypass-domain-censor/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/440568431.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/840944156.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/899237799.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/899237799.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="position:fixed;top:0;right:0;bottom:0;left:0"><div style="position:relative;width:100%;height:100%;overflow:hidden"><canvas style="display:block"></canvas></div></div><div style="pointer-events:stroke;position:absolute;width:100vw"><div><header class="MuiPaper-root MuiAppBar-root MuiAppBar-positionSticky MuiAppBar-colorPrimary jss2 MuiPaper-elevation4"><div class="MuiToolbar-root MuiToolbar-regular MuiToolbar-gutters"><div class="MuiGrid-root MuiGrid-container MuiGrid-align-items-xs-center MuiGrid-justify-xs-space-between"><div class="MuiGrid-root MuiGrid-item"><div class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-2 MuiGrid-align-items-xs-center"><div class="MuiGrid-root MuiGrid-item"><h6 class="MuiTypography-root MuiTypography-h6"><a class="jss6" href="/">Onichandame&#x27;s Home</a></h6></div><div class="MuiGrid-root MuiGrid-item"><a class="jss6" href="/post"><span class="MuiTypography-root MuiTypography-button">blog</span></a></div><div class="MuiGrid-root MuiGrid-item"><a class="jss6" href="/about"><span class="MuiTypography-root MuiTypography-button">about</span></a></div><div class="MuiGrid-root MuiGrid-item"><a class="jss6" href="/contact"><span class="MuiTypography-root MuiTypography-button">contact</span></a></div></div></div><div class="MuiGrid-root MuiGrid-item"><div class="MuiGrid-root MuiGrid-container MuiGrid-align-items-xs-center"><div class="MuiGrid-root MuiGrid-item"><div><button class="MuiButtonBase-root MuiButton-root MuiButton-text" tabindex="0" type="button" aria-controls="language-selector" aria-haspopup="true"><span class="MuiButton-label"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English<svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"></path></svg></span></button></div></div><div class="MuiGrid-root MuiGrid-item"><a class="MuiButtonBase-root MuiIconButton-root" tabindex="0" aria-disabled="false" href="https://github.com/onichandame"><span class="MuiIconButton-label"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 .3a12 12 0 0 0-3.8 23.4c.6.1.8-.3.8-.6v-2c-3.3.7-4-1.6-4-1.6-.6-1.4-1.4-1.8-1.4-1.8-1-.7.1-.7.1-.7 1.2 0 1.9 1.2 1.9 1.2 1 1.8 2.8 1.3 3.5 1 0-.8.4-1.3.7-1.6-2.7-.3-5.5-1.3-5.5-6 0-1.2.5-2.3 1.3-3.1-.2-.4-.6-1.6 0-3.2 0 0 1-.3 3.4 1.2a11.5 11.5 0 0 1 6 0c2.3-1.5 3.3-1.2 3.3-1.2.6 1.6.2 2.8 0 3.2.9.8 1.3 1.9 1.3 3.2 0 4.6-2.8 5.6-5.5 5.9.5.4.9 1 .9 2.2v3.3c0 .3.1.7.8.6A12 12 0 0 0 12 .3"></path></svg></span></a></div></div></div></div></div></header><main class="jss1"><div class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-2 MuiGrid-direction-xs-column"><div class="MuiGrid-root MuiGrid-item"><h3 class="MuiTypography-root MuiTypography-h3">Bypass Domain Censorship</h3></div><div class="MuiGrid-root MuiGrid-item"><div class="MuiGrid-root MuiGrid-container MuiGrid-justify-xs-space-between"><div class="MuiGrid-root MuiGrid-item"><span class="MuiTypography-root MuiTypography-caption">onichandame</span></div><div class="MuiGrid-root MuiGrid-item"><span class="MuiTypography-root MuiTypography-caption">2020-12-20</span></div></div></div><div class="MuiGrid-root MuiGrid-item"><ul><li><a href="#principles">Principles</a><ul><li><a href="#use-a-custom-port">Use A Custom Port</a></li><li><a href="#reverse-proxy">Reverse Proxy</a></li><li><a href="#tls">TLS</a></li></ul></li><li><a href="#recommended-practices">Recommended Practices</a><ul><li><a href="#choice-of-service-provider">Choice of Service Provider</a></li><li><a href="#tls-on-origin">TLS on Origin</a></li><li><a href="#reverse-proxy-1">Reverse Proxy</a></li></ul></li></ul><p>In certain countries or regions, people are not allowed to maintain their own sites without registering the server, domain or IP to the authority. This restriction has some positive effects that the authority can easily find whoever responsible for a site spreading damaging information like terrorism or children pornography. However this also imposes some very difficult inconvenience, especially to the web developers.</p><p>For instance, a developer may want to have a testing server for a project. If the testing site needs to go through the entire registration process, the delivery cycle would be extended unnecessarily just for the registration, not to mention the extra cost of time and money if the registration fails eventually. Moreover, each site must come with a unique testing area as the authority needs to regularly check that the content of the registered site is virtually the same as it was on the registration day.</p><p>Here records some useful techniques in work around the censorship of the domain/server. They are actively updated to reflect the latest change. <strong>Do please respect other people&#x27;s freedom and use them within the legal boundary</strong>.</p><h1>Principles</h1><p>This section records some principles to solve the problem. Based on these principles many different implementations are possible.</p><h2>Use A Custom Port</h2><p>Usually the traffic towards some well-known ports will be scanned and blocked if not found in the registration list. A simple solution would be using a less well-known port to serve. The total amount of ports on the internet is too large to analyze them all in real-time, so a custom port would normally be let go. This is the foundation of any other extended techniques.</p><div class="mermaid" data-processed="true"><svg id="mermaid-1608693442721" width="100%" xmlns="http://www.w3.org/2000/svg" height="249" style="max-width:450px" viewBox="-50 -10 450 249"><style>#mermaid-1608693442721{font-family:&quot;trebuchet ms&quot;,verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1608693442721 .error-icon{fill:#552222;}#mermaid-1608693442721 .error-text{fill:#552222;stroke:#552222;}#mermaid-1608693442721 .edge-thickness-normal{stroke-width:2px;}#mermaid-1608693442721 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1608693442721 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1608693442721 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1608693442721 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1608693442721 .marker{fill:#333333;}#mermaid-1608693442721 .marker.cross{stroke:#333333;}#mermaid-1608693442721 svg{font-family:&quot;trebuchet ms&quot;,verdana,arial,sans-serif;font-size:16px;}#mermaid-1608693442721 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;}#mermaid-1608693442721 text.actor &gt; tspan{fill:black;stroke:none;}#mermaid-1608693442721 .actor-line{stroke:grey;}#mermaid-1608693442721 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333;}#mermaid-1608693442721 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333;}#mermaid-1608693442721 #arrowhead path{fill:#333;stroke:#333;}#mermaid-1608693442721 .sequenceNumber{fill:white;}#mermaid-1608693442721 #sequencenumber{fill:#333;}#mermaid-1608693442721 #crosshead path{fill:#333;stroke:#333;}#mermaid-1608693442721 .messageText{fill:#333;stroke:#333;}#mermaid-1608693442721 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;}#mermaid-1608693442721 .labelText,#mermaid-1608693442721 .labelText &gt; tspan{fill:black;stroke:none;}#mermaid-1608693442721 .loopText,#mermaid-1608693442721 .loopText &gt; tspan{fill:black;stroke:none;}#mermaid-1608693442721 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%);}#mermaid-1608693442721 .note{stroke:#aaaa33;fill:#fff5ad;}#mermaid-1608693442721 .noteText,#mermaid-1608693442721 .noteText &gt; tspan{fill:black;stroke:none;}#mermaid-1608693442721 .activation0{fill:#f4f4f4;stroke:#666;}#mermaid-1608693442721 .activation1{fill:#f4f4f4;stroke:#666;}#mermaid-1608693442721 .activation2{fill:#f4f4f4;stroke:#666;}#mermaid-1608693442721:root{--mermaid-font-family:&quot;trebuchet ms&quot;,verdana,arial,sans-serif;}#mermaid-1608693442721 sequence{fill:apa;}</style><g></g><g><line id="actor0" x1="75" y1="5" x2="75" y2="238" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="0" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor:middle;font-size:14px;font-weight:400;font-family:Open-Sans, sans-serif"><tspan x="75" dy="0">Browser</tspan></text></g><g><line id="actor1" x1="275" y1="5" x2="275" y2="238" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="200" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="275" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor:middle;font-size:14px;font-weight:400;font-family:Open-Sans, sans-serif"><tspan x="275" dy="0">Server</tspan></text></g><defs><marker id="arrowhead" refX="5" refY="2" markerWidth="6" markerHeight="4" orient="auto"><path d="M 0,0 V 4 L6,2 Z"></path></marker></defs><defs><marker id="crosshead" markerWidth="15" markerHeight="8" orient="auto" refX="16" refY="4"><path fill="black" stroke="#000000" stroke-width="1px" d="M 9,2 V 6 L16,4 Z" style="stroke-dasharray:0, 0"></path><path fill="none" stroke="#000000" stroke-width="1px" d="M 0,1 L 6,7 M 6,1 L 0,7" style="stroke-dasharray:0, 0"></path></marker></defs><defs><marker id="sequencenumber" refX="15" refY="15" markerWidth="60" markerHeight="40" orient="auto"><circle cx="15" cy="15" r="6"></circle></marker></defs><text x="175" y="80" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family:&quot;trebuchet ms&quot;, verdana, arial, sans-serif;font-size:16px;font-weight:400">port 80</text><line x1="75" y1="109" x2="275" y2="109" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#crosshead)" style="fill:none"></line><text x="175" y="124" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family:&quot;trebuchet ms&quot;, verdana, arial, sans-serif;font-size:16px;font-weight:400">port 3000</text><line x1="75" y1="153" x2="275" y2="153" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill:none"></line><g><rect x="0" y="173" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="205.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor:middle;font-size:14px;font-weight:400;font-family:Open-Sans, sans-serif"><tspan x="75" dy="0">Browser</tspan></text></g><g><rect x="200" y="173" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="275" y="205.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor:middle;font-size:14px;font-weight:400;font-family:Open-Sans, sans-serif"><tspan x="275" dy="0">Server</tspan></text></g></svg></div><p>Using a custom port brings some difficulties in usage.</p><ol><li>The visitors now have to type in the port in the url like <code>www.example.com:8080</code>.</li><li>In many browsers, a common url is automatically upgraded to <code>https</code>. So you type in <code>www.example.com</code> and the browser takes you to <code>https://www.example.com</code>. This convenience is not possible if a custom port is used though.</li></ol><p>To bypass the inconveniences above, something needs to be done.</p><h2>Reverse Proxy</h2><p>To access the server from a normal port like 80 and 443, a reverse proxy can be used.</p><div class="mermaid" data-processed="true"><svg id="mermaid-1608693442716" width="100%" xmlns="http://www.w3.org/2000/svg" height="249" style="max-width:650px" viewBox="-50 -10 650 249"><style>#mermaid-1608693442716{font-family:&quot;trebuchet ms&quot;,verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1608693442716 .error-icon{fill:#552222;}#mermaid-1608693442716 .error-text{fill:#552222;stroke:#552222;}#mermaid-1608693442716 .edge-thickness-normal{stroke-width:2px;}#mermaid-1608693442716 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1608693442716 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1608693442716 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1608693442716 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1608693442716 .marker{fill:#333333;}#mermaid-1608693442716 .marker.cross{stroke:#333333;}#mermaid-1608693442716 svg{font-family:&quot;trebuchet ms&quot;,verdana,arial,sans-serif;font-size:16px;}#mermaid-1608693442716 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;}#mermaid-1608693442716 text.actor &gt; tspan{fill:black;stroke:none;}#mermaid-1608693442716 .actor-line{stroke:grey;}#mermaid-1608693442716 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333;}#mermaid-1608693442716 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333;}#mermaid-1608693442716 #arrowhead path{fill:#333;stroke:#333;}#mermaid-1608693442716 .sequenceNumber{fill:white;}#mermaid-1608693442716 #sequencenumber{fill:#333;}#mermaid-1608693442716 #crosshead path{fill:#333;stroke:#333;}#mermaid-1608693442716 .messageText{fill:#333;stroke:#333;}#mermaid-1608693442716 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;}#mermaid-1608693442716 .labelText,#mermaid-1608693442716 .labelText &gt; tspan{fill:black;stroke:none;}#mermaid-1608693442716 .loopText,#mermaid-1608693442716 .loopText &gt; tspan{fill:black;stroke:none;}#mermaid-1608693442716 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%);}#mermaid-1608693442716 .note{stroke:#aaaa33;fill:#fff5ad;}#mermaid-1608693442716 .noteText,#mermaid-1608693442716 .noteText &gt; tspan{fill:black;stroke:none;}#mermaid-1608693442716 .activation0{fill:#f4f4f4;stroke:#666;}#mermaid-1608693442716 .activation1{fill:#f4f4f4;stroke:#666;}#mermaid-1608693442716 .activation2{fill:#f4f4f4;stroke:#666;}#mermaid-1608693442716:root{--mermaid-font-family:&quot;trebuchet ms&quot;,verdana,arial,sans-serif;}#mermaid-1608693442716 sequence{fill:apa;}</style><g></g><g><line id="actor0" x1="75" y1="5" x2="75" y2="238" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="0" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor:middle;font-size:14px;font-weight:400;font-family:Open-Sans, sans-serif"><tspan x="75" dy="0">Browser</tspan></text></g><g><line id="actor1" x1="275" y1="5" x2="275" y2="238" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="200" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="275" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor:middle;font-size:14px;font-weight:400;font-family:Open-Sans, sans-serif"><tspan x="275" dy="0">Reverse Proxy</tspan></text></g><g><line id="actor2" x1="475" y1="5" x2="475" y2="238" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="400" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="475" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor:middle;font-size:14px;font-weight:400;font-family:Open-Sans, sans-serif"><tspan x="475" dy="0">Server</tspan></text></g><defs><marker id="arrowhead" refX="5" refY="2" markerWidth="6" markerHeight="4" orient="auto"><path d="M 0,0 V 4 L6,2 Z"></path></marker></defs><defs><marker id="crosshead" markerWidth="15" markerHeight="8" orient="auto" refX="16" refY="4"><path fill="black" stroke="#000000" stroke-width="1px" d="M 9,2 V 6 L16,4 Z" style="stroke-dasharray:0, 0"></path><path fill="none" stroke="#000000" stroke-width="1px" d="M 0,1 L 6,7 M 6,1 L 0,7" style="stroke-dasharray:0, 0"></path></marker></defs><defs><marker id="sequencenumber" refX="15" refY="15" markerWidth="60" markerHeight="40" orient="auto"><circle cx="15" cy="15" r="6"></circle></marker></defs><text x="175" y="80" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family:&quot;trebuchet ms&quot;, verdana, arial, sans-serif;font-size:16px;font-weight:400">port 80</text><line x1="75" y1="109" x2="275" y2="109" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill:none"></line><text x="375" y="124" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family:&quot;trebuchet ms&quot;, verdana, arial, sans-serif;font-size:16px;font-weight:400">port 3000</text><line x1="275" y1="153" x2="475" y2="153" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill:none"></line><g><rect x="0" y="173" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="205.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor:middle;font-size:14px;font-weight:400;font-family:Open-Sans, sans-serif"><tspan x="75" dy="0">Browser</tspan></text></g><g><rect x="200" y="173" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="275" y="205.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor:middle;font-size:14px;font-weight:400;font-family:Open-Sans, sans-serif"><tspan x="275" dy="0">Reverse Proxy</tspan></text></g><g><rect x="400" y="173" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="475" y="205.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor:middle;font-size:14px;font-weight:400;font-family:Open-Sans, sans-serif"><tspan x="475" dy="0">Server</tspan></text></g></svg></div><p>In this case the user(browser) treats the reverse proxy as the &quot;server&quot;. The revese proxy fetches the content from the real server on behalf of the user and returns the content to the user. In this scenario, if the reverse proxy is trusted by the authority then you have set up a server to serve just like any other functioning server without dealing with the authority.</p><h2>TLS</h2><p>Based on the setup above, a combination of a reverse proxy and the use of a custom port has already given you an HTTP server. However, security is still a concern. TLS encryption needed not only because it prevents attack from bad guys, it also helps hide the content from the oversight, hence the chance of getting into troubles is reduced.</p><p>In the circuit shown above, there are 2 connections for every request. Both of the connections need to be protected but different tactics apply.</p><div class="mermaid" data-processed="true"><svg id="mermaid-1608693442682" width="100%" xmlns="http://www.w3.org/2000/svg" height="249" style="max-width:769px" viewBox="-50 -10 769 249"><style>#mermaid-1608693442682{font-family:&quot;trebuchet ms&quot;,verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1608693442682 .error-icon{fill:#552222;}#mermaid-1608693442682 .error-text{fill:#552222;stroke:#552222;}#mermaid-1608693442682 .edge-thickness-normal{stroke-width:2px;}#mermaid-1608693442682 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1608693442682 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1608693442682 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1608693442682 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1608693442682 .marker{fill:#333333;}#mermaid-1608693442682 .marker.cross{stroke:#333333;}#mermaid-1608693442682 svg{font-family:&quot;trebuchet ms&quot;,verdana,arial,sans-serif;font-size:16px;}#mermaid-1608693442682 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;}#mermaid-1608693442682 text.actor &gt; tspan{fill:black;stroke:none;}#mermaid-1608693442682 .actor-line{stroke:grey;}#mermaid-1608693442682 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333;}#mermaid-1608693442682 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333;}#mermaid-1608693442682 #arrowhead path{fill:#333;stroke:#333;}#mermaid-1608693442682 .sequenceNumber{fill:white;}#mermaid-1608693442682 #sequencenumber{fill:#333;}#mermaid-1608693442682 #crosshead path{fill:#333;stroke:#333;}#mermaid-1608693442682 .messageText{fill:#333;stroke:#333;}#mermaid-1608693442682 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;}#mermaid-1608693442682 .labelText,#mermaid-1608693442682 .labelText &gt; tspan{fill:black;stroke:none;}#mermaid-1608693442682 .loopText,#mermaid-1608693442682 .loopText &gt; tspan{fill:black;stroke:none;}#mermaid-1608693442682 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%);}#mermaid-1608693442682 .note{stroke:#aaaa33;fill:#fff5ad;}#mermaid-1608693442682 .noteText,#mermaid-1608693442682 .noteText &gt; tspan{fill:black;stroke:none;}#mermaid-1608693442682 .activation0{fill:#f4f4f4;stroke:#666;}#mermaid-1608693442682 .activation1{fill:#f4f4f4;stroke:#666;}#mermaid-1608693442682 .activation2{fill:#f4f4f4;stroke:#666;}#mermaid-1608693442682:root{--mermaid-font-family:&quot;trebuchet ms&quot;,verdana,arial,sans-serif;}#mermaid-1608693442682 sequence{fill:apa;}</style><g></g><g><line id="actor0" x1="75" y1="5" x2="75" y2="238" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="0" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor:middle;font-size:14px;font-weight:400;font-family:Open-Sans, sans-serif"><tspan x="75" dy="0">Browser</tspan></text></g><g><line id="actor1" x1="294" y1="5" x2="294" y2="238" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="219" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="294" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor:middle;font-size:14px;font-weight:400;font-family:Open-Sans, sans-serif"><tspan x="294" dy="0">Reverse Proxy</tspan></text></g><g><line id="actor2" x1="594" y1="5" x2="594" y2="238" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="519" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="594" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor:middle;font-size:14px;font-weight:400;font-family:Open-Sans, sans-serif"><tspan x="594" dy="0">Server</tspan></text></g><defs><marker id="arrowhead" refX="5" refY="2" markerWidth="6" markerHeight="4" orient="auto"><path d="M 0,0 V 4 L6,2 Z"></path></marker></defs><defs><marker id="crosshead" markerWidth="15" markerHeight="8" orient="auto" refX="16" refY="4"><path fill="black" stroke="#000000" stroke-width="1px" d="M 9,2 V 6 L16,4 Z" style="stroke-dasharray:0, 0"></path><path fill="none" stroke="#000000" stroke-width="1px" d="M 0,1 L 6,7 M 6,1 L 0,7" style="stroke-dasharray:0, 0"></path></marker></defs><defs><marker id="sequencenumber" refX="15" refY="15" markerWidth="60" markerHeight="40" orient="auto"><circle cx="15" cy="15" r="6"></circle></marker></defs><text x="185" y="80" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family:&quot;trebuchet ms&quot;, verdana, arial, sans-serif;font-size:16px;font-weight:400">CA trusted certificate</text><line x1="75" y1="109" x2="294" y2="109" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill:none"></line><text x="444" y="124" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family:&quot;trebuchet ms&quot;, verdana, arial, sans-serif;font-size:16px;font-weight:400">Reverse proxy trusted certificate</text><line x1="294" y1="153" x2="594" y2="153" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill:none"></line><g><rect x="0" y="173" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="205.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor:middle;font-size:14px;font-weight:400;font-family:Open-Sans, sans-serif"><tspan x="75" dy="0">Browser</tspan></text></g><g><rect x="219" y="173" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="294" y="205.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor:middle;font-size:14px;font-weight:400;font-family:Open-Sans, sans-serif"><tspan x="294" dy="0">Reverse Proxy</tspan></text></g><g><rect x="519" y="173" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="594" y="205.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor:middle;font-size:14px;font-weight:400;font-family:Open-Sans, sans-serif"><tspan x="594" dy="0">Server</tspan></text></g></svg></div><p>The certificate of the reverse proxy can be set up in a more convenient way. Many providers like CloudFlare offer it out of the box.</p><p>The certificate installed on the server should be trusted by the reverse proxy. Many service providers offer free certificates signed by themselves for this use case.</p><h1>Recommended Practices</h1><p>This section records the practices I exercised based on the above principles.</p><h2>Choice of Service Provider</h2><p>The key component in the tool chain is the reverse proxy. Normally a cloud service provider is the best choice as it has all the functionalities we need out of the box.</p><p>There surely are many possible options out there. But I have only used CloudFlare, the most popular one.</p><p>CloudFlare is not only a reverse proxy provider, it is also a DNS service provider. Below is how I started to manage my sites and domains using CloudFlare. <a href="https://support.cloudflare.com/hc/en-us/articles/201720164-Creating-a-Cloudflare-account-and-adding-a-website#2YulMb5YJTVnMxgAgNWdS2">The official docs</a> has stated every detail already. I just need to re-emphasize one point relating to the settings of the domain registrar.</p><p>CloudFlare is able to conform with any registrar, as long as the name server settings are correct. The upstream name server should be set to the ones provided by CloudFlare at the registrar&#x27;s dashboard. Then the NS records must be set to match the name server settings. This effect of this change may take several hours to ripple through the entire internet.</p><h2>TLS on Origin</h2><p>In the CloudFlare&#x27;s terminology, the real server serving the site is called &quot;origin&quot;. The proxy mode is on by default to hide the IP address of the origin from attackers. All the DNS records resolve to the same reverse proxy only. The proxy fetches the content from the origin and returns to the visitor on every request. The topology has already been discussed in the <a href="#principles">principle section</a>.</p><p>One issue remaining is the security of the connection between the CloudFlare&#x27;s reverse proxy and the origin. In this single channel, the CloudFlare reverse proxy acts as the client and the origin acts as the server. Hence the TLS certificate installed on the origin must be trusted by the reverse proxy. Fortunately CloudFlare offers free TLS certificate for the domains managed by it.</p><div class="mermaid" data-processed="true"><svg id="mermaid-1608693442727" width="100%" xmlns="http://www.w3.org/2000/svg" height="205" style="max-width:616px" viewBox="-50 -10 616 205"><style>#mermaid-1608693442727{font-family:&quot;trebuchet ms&quot;,verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1608693442727 .error-icon{fill:#552222;}#mermaid-1608693442727 .error-text{fill:#552222;stroke:#552222;}#mermaid-1608693442727 .edge-thickness-normal{stroke-width:2px;}#mermaid-1608693442727 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1608693442727 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1608693442727 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1608693442727 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1608693442727 .marker{fill:#333333;}#mermaid-1608693442727 .marker.cross{stroke:#333333;}#mermaid-1608693442727 svg{font-family:&quot;trebuchet ms&quot;,verdana,arial,sans-serif;font-size:16px;}#mermaid-1608693442727 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;}#mermaid-1608693442727 text.actor &gt; tspan{fill:black;stroke:none;}#mermaid-1608693442727 .actor-line{stroke:grey;}#mermaid-1608693442727 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333;}#mermaid-1608693442727 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333;}#mermaid-1608693442727 #arrowhead path{fill:#333;stroke:#333;}#mermaid-1608693442727 .sequenceNumber{fill:white;}#mermaid-1608693442727 #sequencenumber{fill:#333;}#mermaid-1608693442727 #crosshead path{fill:#333;stroke:#333;}#mermaid-1608693442727 .messageText{fill:#333;stroke:#333;}#mermaid-1608693442727 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;}#mermaid-1608693442727 .labelText,#mermaid-1608693442727 .labelText &gt; tspan{fill:black;stroke:none;}#mermaid-1608693442727 .loopText,#mermaid-1608693442727 .loopText &gt; tspan{fill:black;stroke:none;}#mermaid-1608693442727 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%);}#mermaid-1608693442727 .note{stroke:#aaaa33;fill:#fff5ad;}#mermaid-1608693442727 .noteText,#mermaid-1608693442727 .noteText &gt; tspan{fill:black;stroke:none;}#mermaid-1608693442727 .activation0{fill:#f4f4f4;stroke:#666;}#mermaid-1608693442727 .activation1{fill:#f4f4f4;stroke:#666;}#mermaid-1608693442727 .activation2{fill:#f4f4f4;stroke:#666;}#mermaid-1608693442727:root{--mermaid-font-family:&quot;trebuchet ms&quot;,verdana,arial,sans-serif;}#mermaid-1608693442727 sequence{fill:apa;}</style><g></g><g><line id="actor0" x1="127" y1="5" x2="127" y2="194" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="0" y="0" fill="#eaeaea" stroke="#666" width="254" height="65" rx="3" ry="3" class="actor"></rect><text x="127" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor:middle;font-size:14px;font-weight:400;font-family:Open-Sans, sans-serif"><tspan x="127" dy="0">site.example.com(Reverse Proxy)</tspan></text></g><g><line id="actor1" x1="410" y1="5" x2="410" y2="194" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="304" y="0" fill="#eaeaea" stroke="#666" width="212" height="65" rx="3" ry="3" class="actor"></rect><text x="410" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor:middle;font-size:14px;font-weight:400;font-family:Open-Sans, sans-serif"><tspan x="410" dy="0">origin.example.com(Origin)</tspan></text></g><defs><marker id="arrowhead" refX="5" refY="2" markerWidth="6" markerHeight="4" orient="auto"><path d="M 0,0 V 4 L6,2 Z"></path></marker></defs><defs><marker id="crosshead" markerWidth="15" markerHeight="8" orient="auto" refX="16" refY="4"><path fill="black" stroke="#000000" stroke-width="1px" d="M 9,2 V 6 L16,4 Z" style="stroke-dasharray:0, 0"></path><path fill="none" stroke="#000000" stroke-width="1px" d="M 0,1 L 6,7 M 6,1 L 0,7" style="stroke-dasharray:0, 0"></path></marker></defs><defs><marker id="sequencenumber" refX="15" refY="15" markerWidth="60" markerHeight="40" orient="auto"><circle cx="15" cy="15" r="6"></circle></marker></defs><text x="269" y="80" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family:&quot;trebuchet ms&quot;, verdana, arial, sans-serif;font-size:16px;font-weight:400">TLS certified by CloudFlare</text><line x1="127" y1="109" x2="410" y2="109" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill:none"></line><g><rect x="0" y="129" fill="#eaeaea" stroke="#666" width="254" height="65" rx="3" ry="3" class="actor"></rect><text x="127" y="161.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor:middle;font-size:14px;font-weight:400;font-family:Open-Sans, sans-serif"><tspan x="127" dy="0">site.example.com(Reverse Proxy)</tspan></text></g><g><rect x="304" y="129" fill="#eaeaea" stroke="#666" width="212" height="65" rx="3" ry="3" class="actor"></rect><text x="410" y="161.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor:middle;font-size:14px;font-weight:400;font-family:Open-Sans, sans-serif"><tspan x="410" dy="0">origin.example.com(Origin)</tspan></text></g></svg></div><h2>Reverse Proxy</h2><p>In CloudFlare, the reverse proxy can be achieved in many ways, the most flexible one being <a href="https://workers.cloudflare.com/">worker</a>.</p><p><a href="https://workers.cloudflare.com/">Worker</a> is a serverless technology offered by CloudFlare. To set up a simple reverse proxy simply masking the true destination, only few lines of code is required to make it work:</p><pre><code class="language-javascript">const ORIGIN = &quot;origin.example.com&quot;;
const PORT = `2096`;
addEventListener(&quot;fetch&quot;, (event) =&gt; {
  event.passThroughOnException();
  const url = new URL(event.request.url);
  url.port = PORT;
  url.hostname = ORIGIN;
  const request = new Request(url, event.request);
  return event.respondWith(fetch(request));
});
</code></pre><p>The worker needs to be configured with a route(subdomain) for convenience, otherwise the access url is something randomized and long.</p></div></div></main><footer>© <!-- -->2020<!-- -->, Built with<!-- --> <a href="https://www.gatsbyjs.org">Gatsby</a></footer></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/post/bypass-domain-censor";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-b7eaa380a7ed2e7f6e7f.js"],"app":["/app-a22ec1c5bb75fda00d04.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-b0556ce5127c1a3e2490.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-a5780fd25427dba554e6.js"],"component---src-pages-contact-tsx":["/component---src-pages-contact-tsx-6e01bfbd9b9e3535a9b7.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-f451d7b1cde1ede15351.js"],"component---src-pages-post-tsx":["/component---src-pages-post-tsx-006378b48e558ceea283.js"],"component---src-template-blog-tsx":["/component---src-template-blog-tsx-dc3e87313bcd461c5423.js"],"component---src-template-resume-tsx":["/component---src-template-resume-tsx-c936ed4b5c03d9e27001.js"]};/*]]>*/</script><script src="/polyfill-b7eaa380a7ed2e7f6e7f.js" nomodule=""></script><script src="/component---src-template-blog-tsx-dc3e87313bcd461c5423.js" async=""></script><script src="/c67bc222f24cf6cac9dade081f06b9686691a306-5cb5fd77d6c6846ab638.js" async=""></script><script src="/app-a22ec1c5bb75fda00d04.js" async=""></script><script src="/d5b08420-07f367315fbba8850a0e.js" async=""></script><script src="/fb7d5399-58798ebfc9c8cc593565.js" async=""></script><script src="/4bdf9057-0bb9c0f56db98bc1f503.js" async=""></script><script src="/framework-beda7bde9d7dca0755ce.js" async=""></script><script src="/webpack-runtime-d10adb79bdd5453eb719.js" async=""></script></body></html>