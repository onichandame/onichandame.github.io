{"componentChunkName":"component---src-template-blog-tsx","path":"/post/qcloud-ddns","result":{"data":{"mdx":{"frontmatter":{"title":"DDNS using QCloud and Container","author":"onichandame","date":"2019-05-14T00:00:00.000Z"},"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"DDNS using QCloud and Container\",\n  \"author\": \"onichandame\",\n  \"date\": \"2019-05-14T00:00:00.000Z\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#design\"\n  }), \"Design\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#implementation\"\n  }), \"Implementation\"))), mdx(\"p\", null, \"Recently I bought a domain. I wish to use DDNS to achieve the same result as static IP.(a top domain costs dozens of RMB whereas a static IP costs thousands)\"), mdx(\"h1\", {\n    \"id\": \"design\"\n  }, \"Design\"), mdx(\"p\", null, \"At the server side, QCloud provdes REST API for many of its services. The QCloud domain API can be utilized to programmatically update the secondary domain record.\"), mdx(\"p\", null, \"At the client side, cUrl can be utilized to fetch the public IP address and reach the REST endpoints. Then implementation details are recorded \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://blog.csdn.net/dragon2k/article/details/88016755\"\n  }), \"here\"), \". However, to achieve DDNS, this script needs to be run periodically. There are many ways to do it.\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"periodically run a cron job\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"periodically run a script using watch, and run watch once on reboot using cron\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"run script with watch using docker's \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"--restart always\"), \" flag\")), mdx(\"p\", null, \"The first method is the simplest one. The only customization is the parameters. Setting up a cron job is dead easy. The con of it is that the same setup process has to be repeated for every setup. The secrets will need to be stored in plain text, which is a big no.\"), mdx(\"p\", null, \"The second approach is similar with the first one, with the setup process simplified.\"), mdx(\"p\", null, \"The third method is the best. First of all, all parameters can be passed to container using env variables. No plain text is required. To setup a new DDNS on a new machine, only 1 line of command is required without editing any configuration.\"), mdx(\"h1\", {\n    \"id\": \"implementation\"\n  }, \"Implementation\"), mdx(\"p\", null, \"As a result, I wrote \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/onichandame/qcloud-ddns\"\n  }), \"an image\"), \". All needed is to setup \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"DOMAIN\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"SUBDOMAIN\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"RECORD_ID\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"SECRET_KEY\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"SECRET_ID\"), \" at runtime.\"));\n}\n;\nMDXContent.isMDXComponent = true;","headings":[{"value":"Design","depth":1},{"value":"Implementation","depth":1}]}},"pageContext":{"locale":"en","type":"post","title":"DDNS using QCloud and Container","date":"2019-05-14T00:00:00.000Z","author":"onichandame"}}}